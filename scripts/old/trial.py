from scipy.stats import multivariate_normal, norm
import random
import math
import numpy as np
import itertools
#the sixteen models of configuration.
#SNP = rs2001744
#CHR = 1
#BP = 958248
#p_b = 0.226766
#p_d = 0.624531
#p_h = 1.16258e-08
#p_s = 0.560858
z_b = -1.208735
z_d = -0.4894408
z_h = 5.705306
z_s = -0.5815693
z = np.array([z_b, z_d, z_h, z_s])
#all_configs = [0, 8]
#0 [1.0, 1.0, 1.0, 1.0]
#1 [1.0, 1.0, 1.0, 0.0]
#4 [1.0, 0.0, 1.0, 1.0]
#5 [1.0, 0.0, 1.0, 0.0]
#8 [0.0, 1.0, 1.0, 1.0]
#9 [0.0, 1.0, 1.0, 0.0]
#12[0.0, 0.0, 1.0, 1.0]
#13 [0.0, 0.0, 1.0, 0.0]

#[1.0, 1.0, 1.0, 1.0]
zero = np.array([[1.01043268, 0.24510102, -0.09039904, 0.18273609],
        [0.24510102, 1.00543508, -0.01309825, 0.66423793],
        [-0.09039904, -0.01309825, 1.01917003, -0.10214867],
        [0.18273609, 0.66423793, -0.10214867, 1.00508736]])
#[1.0, 1.0, 1.0, 0.0]
one = np.array([[1.01043268, 0.24510102, -0.09039904, 0.18153111],
       [0.24510102, 1.00543508, -0.01309825, 0.66079792],
       [-0.09039904, -0.01309825, 1.01917003, -0.100774],
       [0.18153111, 0.66079792, -0.100774, 1.]])
#[1.0, 0.0, 1.0, 1.0]
four = np.array([[1.01043268, 0.24288491, -0.09039904, 0.18273609],
        [0.24288491, 1., -0.01195298, 0.66079792],
        [-0.09039904, -0.01195298, 1.01917003, -0.10214867],
        [0.18273609, 0.66079792, -0.10214867, 1.00508736]])
#[1.0, 0.0, 1.0, 0.0]
five = np.array([[1.01043268, 0.24288491, -0.09039904, 0.18153111],
        [0.24288491, 1., -0.01195298, 0.66079792],
        [-0.09039904, -0.01195298, 1.01917003, -0.100774],
        [0.18153111, 0.66079792, -0.100774, 1.]])
#[0.0, 1.0, 1.0, 1.0]
eight = np.array([[1., 0.24288491, -0.08815189, 0.18153111],
         [0.24288491, 1.00543508, -0.01309825, 0.66423793],
         [-0.08815189, -0.01309825, 1.01917003, -0.10214867],
         [0.18153111, 0.66423793, -0.10214867, 1.00508736]])
#[0.0, 1.0, 1.0, 0.0]
nine = np.array([[1., 0.24288491, -0.08815189, 0.18153111],
        [0.24288491, 1.00543508, -0.01309825, 0.66079792],
        [-0.08815189, -0.01309825, 1.01917003, -0.100774],
        [0.18153111, 0.66079792, -0.100774, 1.]])
#[0.0, 0.0, 1.0, 1.0]
twelve = np.array([[1., 0.24288491, -0.08815189, 0.18153111],
          [0.24288491, 1., -0.01195298, 0.66079792],
          [-0.08815189, -0.01195298, 1.01917003, -0.10214867],
          [0.18153111, 0.66079792, -0.10214867, 1.00508736]])
#[0.0, 0.0, 1.0, 0.0]
thirteen = np.array([[ 1., 0.24288491, -0.08815189, 0.18153111],
            [0.24288491, 1., -0.01195298, 0.66079792],
            [-0.08815189, -0.01195298, 1.01917003, -0.100774],
            [0.18153111, 0.66079792, -0.100774, 1.]])
#[0, 1, 4, 5, 8, 9, 12, 13]

print('z: ' + str(z))
value0 = multivariate_normal.pdf(z, np.array([0.0, 0.0, 0.0, 0.0]), zero)
value1 = multivariate_normal.pdf(z, np.array([0.0, 0.0, 0.0, 0.0]), one)
value4 = multivariate_normal.pdf(z, np.array([0.0, 0.0, 0.0, 0.0]), four)
value5 = multivariate_normal.pdf(z, np.array([0.0, 0.0, 0.0, 0.0]), five)
value8 = multivariate_normal.pdf(z, np.array([0.0, 0.0, 0.0, 0.0]), eight)
value9 = multivariate_normal.pdf(z, np.array([0.0, 0.0, 0.0, 0.0]), nine)
value12 = multivariate_normal.pdf(z, np.array([0.0, 0.0, 0.0, 0.0]), twelve)
value13 = multivariate_normal.pdf(z, np.array([0.0, 0.0, 0.0, 0.0]), thirteen)
#all_configs = [0, 1, 4, 5, 8, 9, 12, 13]
#bmi = [0, 1, 4, 5]
#dia = [0, 1, 8, 9]
#sys = [0, 4, 8, 12]
all_configs = value0+value1+value4+value5+value8+value9+value12+value13
bmi = value0+value1+value4+value5
dia = value0+value1+value8+value9
sys = value0+value4+value8+value12
print('all_configs: ' + str(all_configs))
print('bmi: ' + str(bmi))
print('dia: ' + str(dia))
print('sys: ' + str(sys))

print('bmi mvalue: ' + str(bmi/all_configs))
print('dia mvalue: ' + str(dia/all_configs))
print('sys mvalue: ' + str(sys/all_configs))


#SNP = rs597808
#CHR = 12
#BP = 111973358
#p_b = 0.000647712
#p_d = 1.71155e-54
#p_h = 2.83369e-10
#p_s = 3.74324e-18
z_b = 3.41084
z_d = -15.54828
z_h = 6.307818
z_s = -8.686864
z = np.array([z_b, z_d, z_h, z_s])
print('z: ' + str(z))
value0 = multivariate_normal.pdf(z, np.array([0.0, 0.0, 0.0, 0.0]), zero)
value8 = multivariate_normal.pdf(z, np.array([0.0, 0.0, 0.0, 0.0]), eight)
#all_configs = [0, 8]
all_configs = value0+value8
print('all_configs: ' + str(all_configs))
bmi = value0
print('bmi: ' + str(bmi))
print('bmi mvalue: ' + str(bmi/all_configs))
#[1.0, 1.0, 0.0, 1.0]
#two = [[ 1.01043268  0.24510102 -0.08815189  0.18273609]
#[ 0.24510102  1.00543508 -0.01195298  0.66423793]
#[-0.08815189 -0.01195298  1.         -0.100774  ]
#[ 0.18273609  0.66423793 -0.100774    1.00508736]]
#[1.0, 1.0, 0.0, 0.0]
#three = [[ 1.01043268  0.24510102 -0.08815189  0.18153111]
#[ 0.24510102  1.00543508 -0.01195298  0.66079792]
#[-0.08815189 -0.01195298  1.         -0.100774  ]
#[ 0.18153111  0.66079792 -0.100774    1.        ]]
#[1.0, 0.0, 0.0, 1.0]
#six = [[ 1.01043268  0.24288491 -0.08815189  0.18273609]
#[ 0.24288491  1.         -0.01195298  0.66079792]
#[-0.08815189 -0.01195298  1.         -0.100774  ]
#[ 0.18273609  0.66079792 -0.100774    1.00508736]]
#[1.0, 0.0, 0.0, 0.0]
#seven = [[ 1.01043268  0.24288491 -0.08815189  0.18153111]
#[ 0.24288491  1.         -0.01195298  0.66079792]
#[-0.08815189 -0.01195298  1.         -0.100774  ]
#[ 0.18153111  0.66079792 -0.100774    1.        ]]
#[0.0, 1.0, 0.0, 1.0]
#ten = [[ 1.          0.24288491 -0.08815189  0.18153111]
#[ 0.24288491  1.00543508 -0.01195298  0.66423793]
#[-0.08815189 -0.01195298  1.         -0.100774  ]
#[ 0.18153111  0.66423793 -0.100774    1.00508736]]
#[0.0, 1.0, 0.0, 0.0]
#eleven = [[ 1., 0.24288491, -0.08815189, 0.18153111]
#[ 0.24288491, 1.00543508, -0.01195298, 0.66079792]
# [-0.08815189, -0.01195298, 1., -0.100774  ]
#[ 0.18153111  0.66079792 -0.1007741.        ]]
#[0.0, 0.0, 0.0, 1.0]
#fourteen = [[ 1.          0.24288491 -0.08815189  0.18153111]
#[ 0.24288491  1.         -0.01195298  0.66079792]
#[-0.08815189 -0.01195298  1.         -0.100774  ]
#[ 0.18153111  0.66079792 -0.100774    1.00508736]]
#[0.0, 0.0, 0.0, 0.0]
#fifteen = [[ 1.          0.24288491 -0.08815189  0.18153111]
#[ 0.24288491  1.         -0.01195298  0.66079792]
#[-0.08815189 -0.01195298  1.         -0.100774  ]
#[ 0.18153111  0.66079792 -0.100774    1.        ]]
